<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>soul_gateway_src_code_learning_08 | WincherToldYou</title>
  <meta name="description" content="SOUL Admin &amp;amp; 网关 Http长轮询 数据同步书接上回, 使用Http长轮询, 数据同步, soul-admin/src/main/resources/application.yml soul:   sync: #    websocket: #      enabled: true #    zookeeper: #        url: localhost:2181 #">
<meta property="og:type" content="article">
<meta property="og:title" content="soul_gateway_src_code_learning_08">
<meta property="og:url" content="http://wincher.cn/2021/01/23/soul-gateway-src-code-learning-08/index.html">
<meta property="og:site_name" content="WincherToldYou">
<meta property="og:description" content="SOUL Admin &amp;amp; 网关 Http长轮询 数据同步书接上回, 使用Http长轮询, 数据同步, soul-admin/src/main/resources/application.yml soul:   sync: #    websocket: #      enabled: true #    zookeeper: #        url: localhost:2181 #">
<meta property="og:image" content="http://wincher.cn/2021/01/23/soul-gateway-src-code-learning-08/00change_config.png">
<meta property="og:updated_time" content="2021-01-24T17:24:24.074Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="soul_gateway_src_code_learning_08">
<meta name="twitter:description" content="SOUL Admin &amp;amp; 网关 Http长轮询 数据同步书接上回, 使用Http长轮询, 数据同步, soul-admin/src/main/resources/application.yml soul:   sync: #    websocket: #      enabled: true #    zookeeper: #        url: localhost:2181 #">
<meta name="twitter:image" content="http://wincher.cn/2021/01/23/soul-gateway-src-code-learning-08/00change_config.png">
  <!-- Canonical links -->
  <link rel="canonical" href="http://wincher.cn/2021/01/23/soul-gateway-src-code-learning-08/index.html">
  
    <link rel="alternate" href="/atom.xml" title="WincherToldYou" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  <link rel="stylesheet" href="/css/style.css">
  
  
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitment@0.0.3/style/default.min.css">
  
  
  
</head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/Wincher" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpeg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">Wincher</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Software Engineer</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Beijing, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">Repository</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">Links</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">About</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/Wincher" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>Welcome!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ForRemember/">ForRemember</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HBase/">HBase</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/HBase/">HBase</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hive/">Hive</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/operation/">operation</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/感想/">感想</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ForRemember/">ForRemember</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HBase/">HBase</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/">Hive</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOUL/">SOUL</a><span class="tag-list-count">16</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/environment/">environment</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stuff/">stuff</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/感想/">感想</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Docker/" style="font-size: 13.33px;">Docker</a> <a href="/tags/ForRemember/" style="font-size: 13.67px;">ForRemember</a> <a href="/tags/HBase/" style="font-size: 13px;">HBase</a> <a href="/tags/Hive/" style="font-size: 13px;">Hive</a> <a href="/tags/SOUL/" style="font-size: 14px;">SOUL</a> <a href="/tags/environment/" style="font-size: 13px;">environment</a> <a href="/tags/linux/" style="font-size: 13px;">linux</a> <a href="/tags/stuff/" style="font-size: 13.33px;">stuff</a> <a href="/tags/感想/" style="font-size: 13px;">感想</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">Archive</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a><span class="archive-list-count">15</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled ">
        
          <li>
            
            <div class="item-thumb">
              <a href="/2021/02/05/soul-gateway-src-code-learning-18/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/02/05/soul-gateway-src-code-learning-18/" class="title">soul_gateway_src_code_learning_18</a>
              </p>
              <p class="item-date">
                <time datetime="2021-02-05T14:12:00.000Z" itemprop="datePublished">2021-02-05</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-thumb">
              <a href="/2021/02/04/soul-gateway-src-code-learning-17/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/02/04/soul-gateway-src-code-learning-17/" class="title">soul_gateway_src_code_learning_17</a>
              </p>
              <p class="item-date">
                <time datetime="2021-02-04T10:49:23.000Z" itemprop="datePublished">2021-02-04</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-thumb">
              <a href="/2021/02/01/soul-gateway-src-code-learning-16/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/02/01/soul-gateway-src-code-learning-16/" class="title">soul_gateway_src_code_learning_16</a>
              </p>
              <p class="item-date">
                <time datetime="2021-02-01T15:50:07.000Z" itemprop="datePublished">2021-02-01</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-thumb">
              <a href="/2021/01/30/soul-gateway-src-code-learning-15/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/01/30/soul-gateway-src-code-learning-15/" class="title">soul_gateway_src_code_learning_15</a>
              </p>
              <p class="item-date">
                <time datetime="2021-01-30T12:21:31.000Z" itemprop="datePublished">2021-01-30</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-thumb">
              <a href="/2021/01/30/soul-gateway-src-code-learning-14/" class="thumb">
    
    
        <span class="thumb-image thumb-none"></span>
    
</a>

            </div>
            
            <div class="item-inner">
              <p class="item-category">
                
              </p>
              <p class="item-title">
                <a href="/2021/01/30/soul-gateway-src-code-learning-14/" class="title">soul_gateway_src_code_learning_14</a>
              </p>
              <p class="item-date">
                <time datetime="2021-01-29T18:36:35.000Z" itemprop="datePublished">2021-01-30</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-soul-gateway-src-code-learning-08" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      soul_gateway_src_code_learning_08
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2021/01/23/soul-gateway-src-code-learning-08/" class="article-date">
	  <time datetime="2021-01-22T16:13:04.000Z" itemprop="datePublished">2021-01-23</time>
	</a>
</span>
        
        

        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/01/23/soul-gateway-src-code-learning-08/#comments" class="article-comment-link">Comments</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h3 id="SOUL-Admin-amp-网关-Http长轮询-数据同步"><a href="#SOUL-Admin-amp-网关-Http长轮询-数据同步" class="headerlink" title="SOUL Admin &amp; 网关 Http长轮询 数据同步"></a>SOUL Admin &amp; 网关 Http长轮询 数据同步</h3><p>书接上回, 使用Http长轮询, 数据同步,</p>
<p>soul-admin/src/main/resources/application.yml</p>
<pre><code class="yaml">soul:
  sync:
#    websocket:
#      enabled: true
#    zookeeper:
#        url: localhost:2181
#        sessionTimeout: 5000
#        connectionTimeout: 2000
      http:
        enabled: true
</code></pre>
<p>soul-bootstrap/src/main/resources/application-local.yml, 同理</p>
<pre><code class="yaml">soul :
    sync:
#        websocket :
#             urls: ws://localhost:9095/websocket
#        zookeeper:
#             url: localhost:2181
#             sessionTimeout: 5000
#             connectionTimeout: 2000
        http:
             url : http://localhost:9095
</code></pre>
<p>soul-bootstrap/pom.xml  已经添加了</p>
<pre><code class="xml">&lt;!--soul data sync start use http--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.dromara&lt;/groupId&gt;
    &lt;artifactId&gt;soul-spring-boot-starter-sync-data-http&lt;/artifactId&gt;
    &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>分别启动 soul-admin, soul-bootstrap, 注意目前使用http长连接,  bootstrap启动前需要soul-admin已经启动完成, 不然会由于无法通过http连接admin而无法启动,</p>
<p>接下来正常启动我们看到soul-bootstrap log</p>
<pre><code class="bash">2021-01-23 00:36:08.279  INFO 62417 --- [           main] o.d.s.s.data.http.HttpSyncDataService    : request configs: [http://localhost:9095/configs/fetch?groupKeys=APP_AUTH&amp;groupKeys=PLUGIN&amp;groupKeys=RULE&amp;groupKeys=SELECTOR&amp;groupKeys=META_DATA]
2021-01-23 00:36:08.562  INFO 62417 --- [onPool-worker-3] o.d.s.s.d.h.refresh.AppAuthDataRefresh   : clear all appAuth data cache
2021-01-23 00:36:08.570  INFO 62417 --- [           main] o.d.s.s.data.http.HttpSyncDataService    : get latest configs: [{&quot;code&quot;:200,&quot;message&quot;:&quot;success&quot;,&quot;data&quot;:{&quot;META_DATA&quot;:{&quot;md5&quot;:&quot;f96c44af66298be2e76a6b0a55a7b629&quot;,&quot;lastModifyTime&quot;:1611333355313,&quot;data&quot;:[{&quot;id&quot;:&quot;1351785376513667072&quot;,&quot;appName&quot;:&quot;springCloud-test&quot;,&quot;contextPath&quot;:null,&quot;path&quot;:&quot;/springcloud/**&quot;,&quot;rpcType&quot;:&quot;springCloud&quot;,&quot;serviceName&quot;:&quot;springCloud-test&quot;,&quot;methodName&quot;:&quot;/springcloud&quot;,&quot;parameterTypes&quot;:null,&quot;rpcExt&quot;:null,&quot;enabled&quot;:true},{&quot;id&quot;:&quot;1351837754670669824&quot;,&quot;appName&quot;:&quot;sofa&quot;,&quot;contextPath&quot;:null,&quot;path&quot;:&quot;/sofa/insert&quot;,&quot;rpcType&quot;:&quot;sofa&quot;,&quot;serviceName&quot;:&quot;org.dromara.soul.examples.dubbo.api.service.DubboTestService&quot;,&quot;methodName&quot;:&quot;insert&quot;,&quot;parameterTypes&quot;:&quot;org.dromara.soul.examples.dubbo.api.entity.DubboTest&quot;,&quot;rpcExt&quot;:&quot;{\&quot;loadbalance\&quot;:\&quot;hash\&quot;,\&quot;retries\&quot;:3,\&quot;timeout\&quot;:-1}&quot;,&quot;enabled&quot;:true},{&quot;id&quot;:&quot;1351837763067666432&quot;,&quot;appName&quot;:&quot;sofa&quot;,&quot;contextPath&quot;:null,&quot;path&quot;:&quot;/sofa/findAll&quot;,&quot;rpcType&quot;:&quot;sofa&quot;,&quot;serviceName&quot;:&quot;org.dromara.soul.examples.dubbo.api.service.DubboTestService&quot;,&quot;methodName&quot;:&quot;findAll&quot;,&quot;parameterTypes&quot;:null,&quot;rpcExt&quot;:&quot;{\&quot;loadbalance\&quot;:\&quot;hash\&quot;,\&quot;retries\&quot;:3,\&quot;timeout\&quot;:-1}&quot;,&quot;enabled&quot;:true},{&quot;id&quot;:&quot;1351837768541233152&quot;,&quot;appName&quot;:&quot;sofa&quot;,&quot;contextPath&quot;:null,&quot;path&quot;:&quot;/sofa/findById&quot;,&quot;rpcType&quot;:&quot;sofa&quot;,&quot;serviceName&quot;:&quot;org.dromara.soul.examples.dubbo.api.service.DubboTestService&quot;,&quot;methodName&quot;:&quot;findById&quot;,&quot;parameterTypes&quot;:&quot;java.lang.String&quot;,&quot;rpcExt&quot;:&quot;{\&quot;loadbalance\&quot;:\&quot;hash\&quot;,\&quot;retries\&quot;:3,\&quot;timeout\&quot;:-1}&quot;,&quot;enabled&quot;:true}]},&quot;SELECTOR&quot;:{&quot;md5&quot;:&quot;55e041ea36b518946ef09f9ed5d16ffe&quot;,&quot;lastModifyTime&quot;:1611333355190,&quot;data&quot;:[{&quot;id&quot;:&quot;1351785378313023488&quot;,&quot;pluginId&quot;:&quot;8&quot;,&quot;pluginName&quot;:&quot;springCloud&quot;,&quot;name&quot;:&quot;/springcloud&quot;,&quot;matchMode&quot;:0,&quot;type&quot;:1,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;continued&quot;:true,&quot;handle&quot;:&quot;{\&quot;serviceId\&quot;:\&quot;springCloud-test\&quot;}&quot;,&quot;conditionList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/springcloud/**&quot;}]},{&quot;id&quot;:&quot;1351837756520357888&quot;,&quot;pluginId&quot;:&quot;11&quot;,&quot;pluginName&quot;:&quot;sofa&quot;,&quot;name&quot;:&quot;/sofa&quot;,&quot;matchMode&quot;:0,&quot;type&quot;:1,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;continued&quot;:true,&quot;handle&quot;:&quot;sofa&quot;,&quot;conditionList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/sofa/**&quot;}]}]},&quot;PLUGIN&quot;:{&quot;md5&quot;:&quot;5e9a7365763848a4498b445a5a35c0b4&quot;,&quot;lastModifyTime&quot;:1611333351898,&quot;data&quot;:[{&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;sign&quot;,&quot;config&quot;:null,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;10&quot;,&quot;name&quot;:&quot;sentinel&quot;,&quot;config&quot;:null,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;11&quot;,&quot;name&quot;:&quot;sofa&quot;,&quot;config&quot;:&quot;{\&quot;protocol\&quot;:\&quot;zookeeper\&quot;,\&quot;register\&quot;:\&quot;127.0.0.1:2181\&quot;}&quot;,&quot;role&quot;:0,&quot;enabled&quot;:true},{&quot;id&quot;:&quot;12&quot;,&quot;name&quot;:&quot;resilience4j&quot;,&quot;config&quot;:null,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;13&quot;,&quot;name&quot;:&quot;tars&quot;,&quot;config&quot;:null,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;14&quot;,&quot;name&quot;:&quot;context_path&quot;,&quot;config&quot;:null,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;2&quot;,&quot;name&quot;:&quot;waf&quot;,&quot;config&quot;:&quot;{\&quot;model\&quot;:\&quot;black\&quot;}&quot;,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;3&quot;,&quot;name&quot;:&quot;rewrite&quot;,&quot;config&quot;:null,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;4&quot;,&quot;name&quot;:&quot;rate_limiter&quot;,&quot;config&quot;:&quot;{\&quot;master\&quot;:\&quot;mymaster\&quot;,\&quot;mode\&quot;:\&quot;standalone\&quot;,\&quot;url\&quot;:\&quot;192.168.1.1:6379\&quot;,\&quot;password\&quot;:\&quot;abc\&quot;}&quot;,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;5&quot;,&quot;name&quot;:&quot;divide&quot;,&quot;config&quot;:null,&quot;role&quot;:0,&quot;enabled&quot;:true},{&quot;id&quot;:&quot;6&quot;,&quot;name&quot;:&quot;dubbo&quot;,&quot;config&quot;:&quot;{\&quot;register\&quot;:\&quot;zookeeper://localhost:2181\&quot;}&quot;,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;7&quot;,&quot;name&quot;:&quot;monitor&quot;,&quot;config&quot;:&quot;{\&quot;metricsName\&quot;:\&quot;prometheus\&quot;,\&quot;host\&quot;:\&quot;localhost\&quot;,\&quot;port\&quot;:\&quot;9190\&quot;,\&quot;async\&quot;:\&quot;true\&quot;}&quot;,&quot;role&quot;:1,&quot;enabled&quot;:false},{&quot;id&quot;:&quot;8&quot;,&quot;name&quot;:&quot;springCloud&quot;,&quot;config&quot;:null,&quot;role&quot;:1,&quot;enabled&quot;:true},{&quot;id&quot;:&quot;9&quot;,&quot;name&quot;:&quot;hystrix&quot;,&quot;config&quot;:null,&quot;role&quot;:0,&quot;enabled&quot;:false}]},&quot;APP_AUTH&quot;:{&quot;md5&quot;:&quot;d751713988987e9331980363e24189ce&quot;,&quot;lastModifyTime&quot;:1611333351778,&quot;data&quot;:[]},&quot;RULE&quot;:{&quot;md5&quot;:&quot;79088c310f2d3ec32a2c366957fc7165&quot;,&quot;lastModifyTime&quot;:1611333354636,&quot;data&quot;:[{&quot;id&quot;:&quot;1351785381014155264&quot;,&quot;name&quot;:&quot;/springcloud/order/findById&quot;,&quot;pluginName&quot;:&quot;springCloud&quot;,&quot;selectorId&quot;:&quot;1351785378313023488&quot;,&quot;matchMode&quot;:0,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;handle&quot;:&quot;{\&quot;path\&quot;:\&quot;/springcloud/order/findById\&quot;,\&quot;timeout\&quot;:3000}&quot;,&quot;conditionDataList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;=&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/springcloud/order/findById&quot;}]},{&quot;id&quot;:&quot;1351785386563219456&quot;,&quot;name&quot;:&quot;/springcloud/order/path/**&quot;,&quot;pluginName&quot;:&quot;springCloud&quot;,&quot;selectorId&quot;:&quot;1351785378313023488&quot;,&quot;matchMode&quot;:0,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;handle&quot;:&quot;{\&quot;path\&quot;:\&quot;/springcloud/order/path/**\&quot;,\&quot;timeout\&quot;:3000}&quot;,&quot;conditionDataList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/springcloud/order/path/**&quot;}]},{&quot;id&quot;:&quot;1351785391931928576&quot;,&quot;name&quot;:&quot;/springcloud/order/path/**/name&quot;,&quot;pluginName&quot;:&quot;springCloud&quot;,&quot;selectorId&quot;:&quot;1351785378313023488&quot;,&quot;matchMode&quot;:0,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;handle&quot;:&quot;{\&quot;path\&quot;:\&quot;/springcloud/order/path/**/name\&quot;,\&quot;timeout\&quot;:3000}&quot;,&quot;conditionDataList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/springcloud/order/path/**/name&quot;}]},{&quot;id&quot;:&quot;1351785398240161792&quot;,&quot;name&quot;:&quot;/springcloud/order/save&quot;,&quot;pluginName&quot;:&quot;springCloud&quot;,&quot;selectorId&quot;:&quot;1351785378313023488&quot;,&quot;matchMode&quot;:0,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;handle&quot;:&quot;{\&quot;path\&quot;:\&quot;/springcloud/order/save\&quot;,\&quot;timeout\&quot;:3000}&quot;,&quot;conditionDataList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;=&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/springcloud/order/save&quot;}]},{&quot;id&quot;:&quot;1351785403906666496&quot;,&quot;name&quot;:&quot;/springcloud/test/**&quot;,&quot;pluginName&quot;:&quot;springCloud&quot;,&quot;selectorId&quot;:&quot;1351785378313023488&quot;,&quot;matchMode&quot;:0,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;handle&quot;:&quot;{\&quot;path\&quot;:\&quot;/springcloud/test/**\&quot;,\&quot;timeout\&quot;:3000}&quot;,&quot;conditionDataList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/springcloud/test/**&quot;}]},{&quot;id&quot;:&quot;1351837759351513088&quot;,&quot;name&quot;:&quot;/sofa/insert&quot;,&quot;pluginName&quot;:&quot;sofa&quot;,&quot;selectorId&quot;:&quot;1351837756520357888&quot;,&quot;matchMode&quot;:0,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;handle&quot;:&quot;{\&quot;retries\&quot;:0,\&quot;loadBalance\&quot;:\&quot;random\&quot;,\&quot;timeout\&quot;:3000}&quot;,&quot;conditionDataList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;=&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/sofa/insert&quot;}]},{&quot;id&quot;:&quot;1351837764875411456&quot;,&quot;name&quot;:&quot;/sofa/findAll&quot;,&quot;pluginName&quot;:&quot;sofa&quot;,&quot;selectorId&quot;:&quot;1351837756520357888&quot;,&quot;matchMode&quot;:0,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;handle&quot;:&quot;{\&quot;retries\&quot;:0,\&quot;loadBalance\&quot;:\&quot;random\&quot;,\&quot;timeout\&quot;:3000}&quot;,&quot;conditionDataList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;=&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/sofa/findAll&quot;}]},{&quot;id&quot;:&quot;1351837770344783872&quot;,&quot;name&quot;:&quot;/sofa/findById&quot;,&quot;pluginName&quot;:&quot;sofa&quot;,&quot;selectorId&quot;:&quot;1351837756520357888&quot;,&quot;matchMode&quot;:0,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;handle&quot;:&quot;{\&quot;retries\&quot;:0,\&quot;loadBalance\&quot;:\&quot;random\&quot;,\&quot;timeout\&quot;:3000}&quot;,&quot;conditionDataList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;=&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/sofa/findById&quot;}]}]}}}]
</code></pre>
<p>显然我们通过 <a href="http://localhost:9095/configs/fetch" target="_blank" rel="external">http://localhost:9095/configs/fetch</a> 同步了配置</p>
<p>接下来修改一个配置,可以看到</p>
<p><img src="/2021/01/23/soul-gateway-src-code-learning-08/00change_config.png" alt="img"></p>
<p>admin log</p>
<pre><code class="bash">2021-01-23 00:42:55.071  INFO 62391 --- [0.0-9095-exec-5] o.d.s.a.l.AbstractDataChangedListener    : update config cache[SELECTOR], old: {group=&#39;SELECTOR&#39;, md5=&#39;55e041ea36b518946ef09f9ed5d16ffe&#39;, lastModifyTime=1611333660488}, updated: {group=&#39;SELECTOR&#39;, md5=&#39;c8fa3ad3868f3ea1947f3641c753e888&#39;, lastModifyTime=1611333775071}
2021-01-23 00:42:55.077  INFO 62391 --- [-long-polling-2] a.l.h.HttpLongPollingDataChangedListener : send response with the changed group,ip=127.0.0.1, group=SELECTOR, changeTime=1611333775074
</code></pre>
<p>bootstrap log, 看上去像是受到通知,然后去拉的配置</p>
<pre><code class="bash">2021-01-23 00:42:55.079  INFO 62417 --- [-long-polling-1] o.d.s.s.data.http.HttpSyncDataService    : Group config changed: [SELECTOR]
2021-01-23 00:42:55.081  INFO 62417 --- [-long-polling-1] o.d.s.s.data.http.HttpSyncDataService    : request configs: [http://localhost:9095/configs/fetch?groupKeys=SELECTOR]
2021-01-23 00:42:55.127  INFO 62417 --- [-long-polling-1] o.d.s.s.d.h.refresh.AbstractDataRefresh  : update SELECTOR config: {&quot;md5&quot;:&quot;c8fa3ad3868f3ea1947f3641c753e888&quot;,&quot;lastModifyTime&quot;:1611333775071,&quot;data&quot;:[{&quot;id&quot;:&quot;1351785378313023488&quot;,&quot;pluginId&quot;:&quot;8&quot;,&quot;pluginName&quot;:&quot;springCloud&quot;,&quot;name&quot;:&quot;/springcloud&quot;,&quot;matchMode&quot;:0,&quot;type&quot;:1,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;continued&quot;:true,&quot;handle&quot;:&quot;{\&quot;serviceId\&quot;:\&quot;springCloud-test\&quot;}&quot;,&quot;conditionList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/springcloud/**&quot;}]},{&quot;id&quot;:&quot;1351837756520357888&quot;,&quot;pluginId&quot;:&quot;11&quot;,&quot;pluginName&quot;:&quot;sofa&quot;,&quot;name&quot;:&quot;/sofa&quot;,&quot;matchMode&quot;:0,&quot;type&quot;:1,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;continued&quot;:true,&quot;handle&quot;:&quot;sofa&quot;,&quot;conditionList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/sofa/**&quot;}]},{&quot;id&quot;:&quot;1352658003622137856&quot;,&quot;pluginId&quot;:&quot;5&quot;,&quot;pluginName&quot;:&quot;divide&quot;,&quot;name&quot;:&quot;mo&quot;,&quot;matchMode&quot;:0,&quot;type&quot;:1,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;continued&quot;:true,&quot;handle&quot;:&quot;[{\&quot;upstreamHost\&quot;:\&quot;baidu.com\&quot;,\&quot;protocol\&quot;:\&quot;http://\&quot;,\&quot;upstreamUrl\&quot;:\&quot;baidu.com\&quot;,\&quot;weight\&quot;:\&quot;50\&quot;,\&quot;status\&quot;:true,\&quot;timestamp\&quot;:\&quot;0\&quot;,\&quot;warmup\&quot;:\&quot;0\&quot;}]&quot;,&quot;conditionList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;\u003d&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/&quot;}]}]}
2021-01-23 00:42:55.135  INFO 62417 --- [-long-polling-1] o.d.s.s.data.http.HttpSyncDataService    : get latest configs: [{&quot;code&quot;:200,&quot;message&quot;:&quot;success&quot;,&quot;data&quot;:{&quot;SELECTOR&quot;:{&quot;md5&quot;:&quot;c8fa3ad3868f3ea1947f3641c753e888&quot;,&quot;lastModifyTime&quot;:1611333775071,&quot;data&quot;:[{&quot;id&quot;:&quot;1351785378313023488&quot;,&quot;pluginId&quot;:&quot;8&quot;,&quot;pluginName&quot;:&quot;springCloud&quot;,&quot;name&quot;:&quot;/springcloud&quot;,&quot;matchMode&quot;:0,&quot;type&quot;:1,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;continued&quot;:true,&quot;handle&quot;:&quot;{\&quot;serviceId\&quot;:\&quot;springCloud-test\&quot;}&quot;,&quot;conditionList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/springcloud/**&quot;}]},{&quot;id&quot;:&quot;1351837756520357888&quot;,&quot;pluginId&quot;:&quot;11&quot;,&quot;pluginName&quot;:&quot;sofa&quot;,&quot;name&quot;:&quot;/sofa&quot;,&quot;matchMode&quot;:0,&quot;type&quot;:1,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;continued&quot;:true,&quot;handle&quot;:&quot;sofa&quot;,&quot;conditionList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;match&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/sofa/**&quot;}]},{&quot;id&quot;:&quot;1352658003622137856&quot;,&quot;pluginId&quot;:&quot;5&quot;,&quot;pluginName&quot;:&quot;divide&quot;,&quot;name&quot;:&quot;mo&quot;,&quot;matchMode&quot;:0,&quot;type&quot;:1,&quot;sort&quot;:1,&quot;enabled&quot;:true,&quot;loged&quot;:true,&quot;continued&quot;:true,&quot;handle&quot;:&quot;[{\&quot;upstreamHost\&quot;:\&quot;baidu.com\&quot;,\&quot;protocol\&quot;:\&quot;http://\&quot;,\&quot;upstreamUrl\&quot;:\&quot;baidu.com\&quot;,\&quot;weight\&quot;:\&quot;50\&quot;,\&quot;status\&quot;:true,\&quot;timestamp\&quot;:\&quot;0\&quot;,\&quot;warmup\&quot;:\&quot;0\&quot;}]&quot;,&quot;conditionList&quot;:[{&quot;paramType&quot;:&quot;uri&quot;,&quot;operator&quot;:&quot;=&quot;,&quot;paramName&quot;:&quot;/&quot;,&quot;paramValue&quot;:&quot;/&quot;}]}]}}}]
</code></pre>
<p>根据log查看HttpSyncDataService逻辑, 同样实现了SyncDataService接口</p>
<pre><code class="java">//构造方法调用start方法
private void start() {
        // It could be initialized multiple times, so you need to control that.
        if (RUNNING.compareAndSet(false, true)) {
            // fetch all group configs.
            this.fetchGroupConfig(ConfigGroupEnum.values());
            int threadSize = serverList.size();
            this.executor = new ThreadPoolExecutor(threadSize, threadSize, 60L, TimeUnit.SECONDS,
                    new LinkedBlockingQueue&lt;&gt;(),
                    SoulThreadFactory.create(&quot;http-long-polling&quot;, true));
            // start long polling, each server creates a thread to listen for changes.
            this.serverList.forEach(server -&gt; this.executor.execute(new HttpLongPollingTask(server)));
        } else {
            log.info(&quot;soul http long polling was started, executor=[{}]&quot;, executor);
        }
    }
</code></pre>
<pre><code class="java">class HttpLongPollingTask implements Runnable {

        private String server;

        private final int retryTimes = 3;

        HttpLongPollingTask(final String server) {
            this.server = server;
        }

        @Override
        public void run() {
            while (RUNNING.get()) {
                for (int time = 1; time &lt;= retryTimes; time++) {
                    try {
                      //核心长轮询, 看下面
                        doLongPolling(server);
                    } catch (Exception e) {
                        // print warnning log.
                        if (time &lt; retryTimes) {
                            log.warn(&quot;Long polling failed, tried {} times, {} times left, will be suspended for a while! {}&quot;,
                                    time, retryTimes - time, e.getMessage());
                            ThreadUtils.sleep(TimeUnit.SECONDS, 5);
                            continue;
                        }
                        // print error, then suspended for a while.
                        log.error(&quot;Long polling failed, try again after 5 minutes!&quot;, e);
                        ThreadUtils.sleep(TimeUnit.MINUTES, 5);
                    }
                }
            }
            log.warn(&quot;Stop http long polling.&quot;);
        }
    }
</code></pre>
<pre><code class="java">private void doLongPolling(final String server) {
        MultiValueMap&lt;String, String&gt; params = new LinkedMultiValueMap&lt;&gt;(8);
        for (ConfigGroupEnum group : ConfigGroupEnum.values()) {
            ConfigData&lt;?&gt; cacheConfig = factory.cacheConfigData(group);
            String value = String.join(&quot;,&quot;, cacheConfig.getMd5(), String.valueOf(cacheConfig.getLastModifyTime()));
            params.put(group.name(), Lists.newArrayList(value));
        }
        HttpHeaders headers = new HttpHeaders();
        headers.setContentType(MediaType.APPLICATION_FORM_URLENCODED);
        HttpEntity httpEntity = new HttpEntity(params, headers);
        String listenerUrl = server + &quot;/configs/listener&quot;;
        log.debug(&quot;request listener configs: [{}]&quot;, listenerUrl);
        JsonArray groupJson = null;
        try {
          //请求listener查看是否有变坏
            String json = this.httpClient.postForEntity(listenerUrl, httpEntity, String.class).getBody();
            log.debug(&quot;listener result: [{}]&quot;, json);
            groupJson = GSON.fromJson(json, JsonObject.class).getAsJsonArray(&quot;data&quot;);
        } catch (RestClientException e) {
            String message = String.format(&quot;listener configs fail, server:[%s], %s&quot;, server, e.getMessage());
            throw new SoulException(message, e);
        }

        if (groupJson != null) {
            // fetch group configuration async.
            ConfigGroupEnum[] changedGroups = GSON.fromJson(groupJson, ConfigGroupEnum[].class);
            if (ArrayUtils.isNotEmpty(changedGroups)) {
                log.info(&quot;Group config changed: {}&quot;, Arrays.toString(changedGroups));
              //如果有变化,发送请求获取配置
                this.doFetchGroupConfig(server, changedGroups);
            }
        }
    }
</code></pre>
<p>CongfigController</p>
<pre><code class="java">//依赖于HttpLongPollingDataChangedListener, HttpLongPollingDataChangedListener依赖于配置的soul.sync.http.enable
@ConditionalOnBean(HttpLongPollingDataChangedListener.class)
@RestController
@RequestMapping(&quot;/configs&quot;)
@Slf4j
public class ConfigController {
    @PostMapping(value = &quot;/listener&quot;)
    public void listener(final HttpServletRequest request, final HttpServletResponse response) {
        longPollingListener.doLongPolling(request, response);
    }
}
</code></pre>
<pre><code class="java">public void doLongPolling(final HttpServletRequest request, final HttpServletResponse response) {

        //对比请求携带的配置md5, 如果与当前不一致证明已经更新, 这里面细节就先不详看了
        List&lt;ConfigGroupEnum&gt; changedGroup = compareChangedGroup(request);
        String clientIp = getRemoteIp(request);

        // 如果有变化直接就返回 变化的配置group
        if (CollectionUtils.isNotEmpty(changedGroup)) {
            this.generateResponse(response, changedGroup);
            log.info(&quot;send response with the changed group, ip={}, group={}&quot;, clientIp, changedGroup);
            return;
        }

        // listen for configuration changed.
        final AsyncContext asyncContext = request.startAsync();

        // AsyncContext.settimeout() does not timeout properly, so you have to control it yourself
        asyncContext.setTimeout(0L);

        // block client&#39;s thread.
        scheduler.execute(new LongPollingClient(asyncContext, clientIp, HttpConstants.SERVER_MAX_HOLD_TIMEOUT));
    }
</code></pre>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://wincher.cn/2021/01/23/soul-gateway-src-code-learning-08/" title="soul_gateway_src_code_learning_08" target="_blank" rel="external">http://wincher.cn/2021/01/23/soul-gateway-src-code-learning-08/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/Wincher" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpeg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/Wincher" target="_blank"><span class="text-dark">Wincher</span><small class="ml-1x">Software Engineer</small></a></h3>
        <div>Mainly using Java</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	

    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2021/01/23/soul-gateway-src-code-learning-09/" title="soul_gateway_src_code_learning_09"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;Newer</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2021/01/22/soul-gateway-src-code-learning-07/" title="soul_gateway_src_code_learning_07"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>$</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>Maybe you could buy me a cup of coffee.</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/avatar.jpeg" alt="Scan Qrcode" title="Scan" />
              </div>
              <p class="text-muted mv">Scan this qrcode</p>
              <p class="text-grey">Open alipay app scan this qrcode, buy me a coffee!</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/avatar.jpeg" alt="Scan Qrcode" title="Scan" />
              </div>
              <p class="text-muted mv">Scan this qrcode</p>
              <p class="text-grey">Open wechat app scan this qrcode, buy me a coffee!</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> alipay</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> wechat payment</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/Wincher" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script src="/js/plugin.min.js"></script>
<script src="/js/application.js"></script>

    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>





   




   
    
<script src="//cdn.jsdelivr.net/npm/gitment@0.0.3/dist/gitment.browser.min.js"></script>
<script>
var gitment = new Gitment({
  // id默认为当前页面url，如果url后带参数或锚点，gitment要重新初始化
  // https://github.com/imsun/gitment/issues/55
  // 解决方案：id:window.location.pathname,或者将id设置为当前页面标题
  id: 'soul_gateway_src_code_learning_08', 
  owner: '', // 可以是你的GitHub用户名，也可以是github id
  repo: '',
  oauth: {
    client_id: '',
    client_secret: '',
  }
})
gitment.render('comments')
</script>









</body>
</html>